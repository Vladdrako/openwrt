menu "Configuration"
	depends on PACKAGE_dropbear

menu "Public key algorithm selection"

config DROPBEAR_RSA
	bool "RSA support"
	default y
	help
		Enable support for the RSA public key algorithm.

config DROPBEAR_ECC
	bool "Elliptic curve cryptography (ECC)"
	help
		Enables basic support for elliptic curve cryptography (ECC)
		in key exchange and public key authentication.

		Key exchange algorithms:
		  ecdh-sha2-nistp256

		Public key algorithms:
		  ecdsa-sha2-nistp256

		Increases binary size by about 24 kB (MIPS).

		Note: select DROPBEAR_ECC_FULL if full ECC support is required.

config DROPBEAR_ECC_FULL
	bool "Elliptic curve cryptography (ECC), full support"
	depends on DROPBEAR_ECC
	help
		Enables full support for elliptic curve cryptography (ECC)
		in key exchange and public key authentication.

		Key exchange algorithms:
		  ecdh-sha2-nistp256 (*)
		  ecdh-sha2-nistp384
		  ecdh-sha2-nistp521

		Public key algorithms:
		  ecdsa-sha2-nistp256 (*)
		  ecdsa-sha2-nistp384
		  ecdsa-sha2-nistp521

		(*) - basic ECC support; provided by DROPBEAR_ECC.

		Increases binary size by about 4 kB (MIPS).

config DROPBEAR_SK_ECDSA
	bool "U2F security key support for ECDSA"
	default y
	depends on DROPBEAR_ECC
	help
		Support U2F security keys for ECDSA public key authentication.

config DROPBEAR_ED25519
	bool "Ed25519 support"
	default y if !SMALL_FLASH
	help
		This enables the following public key algorithm:
		  ssh-ed25519

		Increases binary size by about 12 kB (MIPS).

config DROPBEAR_SK_ED25519
	bool "U2F security key support for Ed25519"
	default y
	depends on DROPBEAR_ED25519
	help
		Support U2F security keys for Ed25519 public key authentication.

config DROPBEAR_AUTOSEL_PK
	def_bool y
	depends on !(DROPBEAR_ECC || DROPBEAR_ED25519)
	select DROPBEAR_RSA

endmenu

menu "Encryption algorithm selection"

config DROPBEAR_AES128
	bool "AES-128 support"
	default y
	help
		This enables support for the 128-bit AES cipher

config DROPBEAR_AES256
	bool "AES-256 support"
	default y
	help
		This enables support for the 256-bit AES cipher

config DROPBEAR_CHACHA20POLY1305
	bool "Chacha20-Poly1305 support"
	default y
	help
		This enables the following authenticated encryption cipher:
		  chacha20-poly1305@openssh.com

		Increases binary size by about 4 kB (MIPS).

config DROPBEAR_AUTOSEL_EA
	def_bool y
	depends on !(DROPBEAR_AES256 || DROPBEAR_CHACHA20POLY1305)
	select DROPBEAR_AES128

endmenu

menu "Key exchange algorithm selection"

config DROPBEAR_DH_GROUP14_SHA1
	bool "Group 14 SHA-1"
	default y

config DROPBEAR_DH_GROUP14_SHA256
	bool "Group 14 SHA-256"
	default y

config DROPBEAR_CURVE25519
	bool "Curve25519 support"
	default y
	help
		This enables the following key exchange algorithm:
		  curve25519-sha256@libssh.org

		Increases binary size by about 4 kB (MIPS).

config DROPBEAR_AUTOSEL_KEX
	def_bool y
	depends on !(DROPBEAR_DH_GROUP14_SHA1 || DROPBEAR_CURVE25519)
	select DROPBEAR_DH_GROUP14_SHA256

endmenu

menu "Message integrity (HMAC) algorithm selection"

config DROPBEAR_SHA1_HMAC
	bool "SHA-1 HMAC"
	default y

config DROPBEAR_SHA2_256_HMAC
	bool "SHA-256 HMAC"
	default y

config DROPBEAR_AUTOSEL_HMAC
	def_bool y
	depends on !DROPBEAR_SHA1_HMAC
	select DROPBEAR_SHA2_256_HMAC

endmenu

config DROPBEAR_ZLIB
	bool "Enable compression"
	help
		Enables compression using shared zlib library.

		Increases binary size by about 0.1 kB (MIPS) and requires
		additional 62 kB (MIPS) for a shared zlib library.

config DROPBEAR_UTMP
	bool "Utmp support"
	depends on BUSYBOX_CONFIG_FEATURE_UTMP
	help
		This enables dropbear utmp support, the file /var/run/utmp is
		used to track who is currently logged in.

config DROPBEAR_PUTUTLINE
	bool "Pututline support"
	depends on DROPBEAR_UTMP
	help
		Dropbear will use pututline() to write the utmp structure into
		the utmp file.

config DROPBEAR_DBCLIENT
	bool "Build dropbear with dbclient"
	default y

config DROPBEAR_DBCLIENT_AGENTFORWARD
	bool "Enable agent forwarding in dbclient [LEGACY/SECURITY]"
	default y
	depends on DROPBEAR_DBCLIENT
	help
		Increases binary size by about 0.1 kB (MIPS).

		Security notes:

		SSH agent forwarding might cause security issues (locally and
		on the jump machine).

		Hovewer, it's enabled by default for compatibility with
		previous OpenWrt/dropbear releases.

		Consider DISABLING this option if you're building own OpenWrt
		image.

		Also see DROPBEAR_AGENTFORWARD (agent forwarding in dropbear
		server itself).

config DROPBEAR_SCP
	bool "Build dropbear with scp"
	default y

config DROPBEAR_ASKPASS
	bool "Enable askpass helper support"
	depends on DROPBEAR_DBCLIENT
	help
		This enables support for ssh-askpass helper in dropbear client
		in order to authenticate on remote hosts.

		Increases binary size by about 0.1 kB (MIPS).

config DROPBEAR_AGENTFORWARD
	bool "Enable agent forwarding [LEGACY/SECURITY]"
	default y
	help
		Increases binary size by about 0.1 kB (MIPS).

		Security notes:

		SSH agent forwarding might cause security issues (locally and
		on the jump machine).

		Hovewer, it's enabled by default for compatibility with
		previous OpenWrt/dropbear releases.

		Consider DISABLING this option if you're building own OpenWrt
		image.

		Also see DROPBEAR_DBCLIENT_AGENTFORWARD (agent forwarding in
		dropbear client) if DROPBEAR_DBCLIENT is selected.

config DROPBEAR_REEXEC
	bool "Re-execute for new connections"
	default y
	help
		Instead of forking, re-execute the dropbear process for each incoming connection.
		This allows ASLR to randomise address space for each connection as a security
		mitigation.

endmenu
