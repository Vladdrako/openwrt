From 8285d335f46673b81a00c09e784eef64b0135b47 Mon Sep 17 00:00:00 2001
From: Simon Kelley <simon@thekelleys.org.uk>
Date: Wed, 12 Jan 2022 23:05:25 +0000
Subject: [PATCH 12/16] Fix error introduced in
 11c52d032be7a111094419194fc8cb03802d0edf

---
 src/dnssec.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/dnssec.c b/src/dnssec.c
index 84ad48f..028a317 100644
--- a/src/dnssec.c
+++ b/src/dnssec.c
@@ -2101,7 +2101,7 @@ int dnssec_validate_reply(time_t now, struct dns_header *header, size_t plen, ch
 	      if (qtype == T_DS)
 		return STAT_BOGUS | DNSSEC_FAIL_NONSEC;
 	      
-	      if (STAT_ISEQUAL((rc = zone_status(name, qclass, keyname, now)), STAT_SECURE))
+	      if (!STAT_ISEQUAL((rc = zone_status(name, qclass, keyname, now)), STAT_SECURE))
 		{
 		  if (class)
 		    *class = qclass; /* Class for NEED_DS or NEED_KEY */
-- 
2.34.1

