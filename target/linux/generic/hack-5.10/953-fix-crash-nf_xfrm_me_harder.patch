--- a/net/netfilter/nf_nat_core.c
+++ b/net/netfilter/nf_nat_core.c
@@ -160,6 +160,8 @@
 		return err;
 
 	dst = skb_dst(skb);
+    if (!dst)
+		return -EHOSTUNREACH;
 	if (dst->xfrm)
 		dst = ((struct xfrm_dst *)dst)->route;
 	if (!dst_hold_safe(dst))
